---
title: "Evolu√ß√£o dos Pre√ßos das Commodities - Agropecu√°ria"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

# Pacotes necess√°rios

library(ggplot2)
library(gganimate)
library(dplyr)
library(scales)
library(GetBCBData)
library(tidyverse)
library(showtext)

# Fonte moderna
font_add_google("Roboto", "roboto")
showtext_auto()

# DADOS
my.id <- c(agropecu√°ria = 29041)

df.bcb <- gbcbd_get_series(id = my.id,
                           first.date = '1998-01-31',
                           last.date = Sys.Date(),
                           format.data = 'long',
                           use.memoise = TRUE,
                           cache.path = tempdir(),
                           do.parallel = FALSE)

glimpse(df.bcb)
```

## **Pre√ßos das Commodities - Agropecu√°ria**

Commodities s√£o produtos naturais com uma m√≠nima industrializa√ß√£o, sendo capazes de serem comercializadas entre pa√≠ses, sendo muito voltada para a exporta√ß√£o, principalmente no Brasil. Exemplos s√£o as commodities:

-   **Agr√≠colas:** soja, milho, caf√©, algod√£o, trigo

-   **Energ√©ticas:** petr√≥leo, g√°s natural, etanol

-   **Minerais e met√°licas:** ouro, ferro, cobre, alum√≠nio

Todas elas tem uma varia√ß√£o nos pre√ßos conforme o mercado se constituem, em per√≠odos de crescimento econ√¥mico e escassez de mat√©ria-prima para a produ√ß√£o, seus pre√ßos aumentam, mas em per√≠odos de crise em que se da prefer√™ncia por bens de necessidade. Em per√≠odos de conflitos globais, elas variam, principalmente por conta de embargos econ√¥micos e altas taxa√ß√µes. Os desastres naturais contribuem para o aumento dos pre√ßos por conta de uma for√ßada diminui√ß√£o da oferta no mercado.

## **Gr√°fico em Painel ‚Äì Varia√ß√£o dos pre√ßos das commodities agropecu√°rias ao longo dos anos**

No gr√°fico, √© poss√≠vel identificar dois pontos de queda , ambos influenciados por quest√µes financeiras. Em 2008, a economia mundial passava por uma recess√£o, influenciada pela bolha de cr√©dito dos EUA. Em 2020, o planeta Terra enfrentava um grande atraso gra√ßas a um v√≠rus chamado COVID-19.\
√â interessante perceber que nos dois anos houve uma acentuada queda, mas que em quest√£o de 2 a 3 anos, houveram as maiores recupera√ß√µes j√° vistas, muito impactados por uma alta na demanda - quando a economia volta a crescer - e por uma baixa oferta, influenciada por uma fuga de agricultores do ramo por uma falta de expectativa de crescimento e valoriza√ß√£o do setor.\
\
Muitas vezes, uma queda pode ser uma oportunidade para um crescimento ainda maior - "dar um passo pra tr√°s pra poder dar dois pra frente".

```{r}
#| label: graficodadosempainel
#| warning: false
#| echo: false

# GR√ÅFICO MODERNO E ANIMADO COM EVENTOS HIST√ìRICOS
ggplot(df.bcb, aes(x = ref.date, y = value)) +
  geom_line(color = "#35AE35", size = 1.5) +
  geom_point(color = "#35AE35", size = 2, alpha = 0.8) +
  
   # EVENTOS: linhas verticais
  geom_vline(xintercept = as.Date("2008-09-01"), linetype = "dashed",
             color = "#2C3E50", size = 1) +
  geom_vline(xintercept = as.Date("2020-03-01"), linetype = "dashed",
             color = "#2C3E50", size = 1) +
  
    # EVENTOS: textos explicativos
  annotate("text", x = as.Date("2008-09-01"), y = max(df.bcb$value) * 0.93,
           label = "üìâ Crise de 2008", color = "#E67E22", angle = 90, vjust = -0.5, size = 6) +
  annotate("text", x = as.Date("2020-03-01"), y = max(df.bcb$value) * 0.95,
           label = "ü¶† Pandemia", color = "#E67E22", angle = 90, vjust = -0.5, size = 6) +
  
  # T√≠tulos e estilo
  labs(
    title = 'üíπ Pre√ßos das Commodities - Agropecu√°ria',
    subtitle = 'Data: {format(frame_along, "%b/%Y")} ‚Äî Fonte: Banco Central do Brasil',
    x = NULL,
    y = NULL
  ) +
  scale_x_date(date_labels = "%Y", date_breaks = "3 years") +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  theme_minimal(base_family = "roboto") +
  theme(
    plot.title = element_text(size = 20, face = "bold", color = "#2C3E50"),
    plot.subtitle = element_text(size = 13, color = "#7F8C8D", margin = margin(b = 10)),
    axis.text = element_text(size = 10, color = "#34495E"),
    panel.grid.major = element_line(color = "#ecf0f1"),
    panel.grid.minor = element_blank(),
    plot.margin = margin(20, 30, 20, 30),
    plot.background = element_rect(fill = "white", color = NA)
  ) +
  transition_reveal(ref.date)
```
